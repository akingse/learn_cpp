## 工业软件底层技术200个知识点



### 设计模式

[设计模式](https://sourcemaking.com/design_patterns)：1.单例模式 2.工厂/抽象工厂模式 3.观察者模式

### 数据结构

数据结构--树，包括二叉树，平衡二叉树，B树，红黑树。

数据结构--栈和队列

栈(stack)是一种数据结构，其特点是先进后出，类似一个弹夹，先放进去的子弹最后出来。

R树是用来做空间数据存储的树状数据结构。



### 智能指针

建议强制使用unique_ptr

std::unique_ptr是从C++11开始提供的智能指针(smart point)，在头文件<memory>中定义。它持有对对象的独有权，两个unique_ptr不能指向一个对象，不能进行复制操作只能进行移动操作。

### 面向对象思想

封装，继承，多态是面向对象软件设计的三大特点，是现代软件研发必须掌握的思想和方法。

### 数值精度

数值精度是指在程序中数据的有效截断长度。比如float型小数点保留到第7位，double型保存到第15位。在工业软件中，数值精度是一个经常会带来问题的因素。

一般的渲染数据因为作用只是用来显示，不需要太多复杂的计算，float型数据就足够了；而几何建模，网格划分，求解器计算一般使用double型数据；几何内核数的数值精度通常设在8位以上，如果使用float型数据就会造成数据最后几位丢失，引发各种问题。

### 多线程OpenMP

OpenMP是共享内存多线程任务，无需编写额外代码，只需要在代码中编写相关指令

### 几何内核和渲染引擎

1. 一般的几何内核组件主要是数据结构和算法，没有自带的渲染显示系统。也就是说如果只有几何内核，是没办法将几何对象渲染显示的。需要单独对几何数据独立开发渲染系统
2. 大场景大模型的渲染性能是工业设计仿真软件中的一大瓶颈，如果要在渲染上深入挖掘性能，可能需要自己开发显示引擎
3. 几何内核和渲染引擎是独立存在的模块，两者之间没有必然的联系。
4. 渲染引擎有原生态的OpenGL，DiretX，以及进行过封装的开源OSG，OGRE，VTK，还有很多商业渲染引擎
5. 几何数据离散成三角形是几何内核的一个基本功能，一是可以用来做渲染，仿真软件中还可以用于后续的网格细化等功能
6. 对于一般的渲染图形需求，尽量使用渲染引擎解决。

7. 拾取，捕捉等操作计算，可以只用渲染数据，也可以只使用几何数据。

8. 几何内核一般精度是double型，显示渲染可以float型。



### 矩阵分解 

(Matrix Decomposition或者Matrix factorization)是将矩阵拆解为数个矩阵的乘积，常用类型有：

1. LU分解:将矩阵A分解为下三角矩阵L和上三角矩阵U的乘积的形式；
2. QR分解:将矩阵A分解为正交矩阵Q和上三角矩阵R的乘积形式；
3. Cholesky分解:将一个对称正定矩阵A分解为一个下三角矩阵L的转置与其本身的乘积的形式；
4. 奇异值分解(SVD):将矩阵分解为两个正交矩阵和一个对角矩阵的乘积形式；
5. 特征值分解:将方阵分解为特征向量矩阵和对角特征值矩阵的乘积形式；
6. Schur分解:将方阵分解为单位上三角矩阵和上三角矩阵的和的形式；
7. Jordan分解:利用元素的某些特殊结构,分解为多个矩阵相乘的形式

### OpenGL转换矩阵

一个现实中的模型数据转换成渲染数据流程如下：

1.模型变换--将准备拍摄的对象移动到场景中指定位置

2.视图变换--将相机移动到准备拍摄的位置，将它对准某个方向

3.投影变换--设置相机的焦距，或者调整缩放比例

4.视口变换--拍摄照片并变换到需要的图片大小



### 边界表示法BRep

(Boundary Representation)

边界表示法又简称为BRep方法或BRep格式，它是目前工业软件领域底层几何数据最常用的表示方法。几何内核ACIS/Parasolid/C3D/CGM/OCC等都采用这种数据表示方法。

![图片](https://mmbiz.qpic.cn/mmbiz_jpg/RokBa0AN9Sv3wdygCkiavPibKE6wbiclmaiceiaOK5OIgPQiafbNfXLskDCCwbbF1xeibmGZICn5QEcJvKAev0w1lLZuw/640?wx_fmt=jpeg&wxfrom=5&wx_lazy=1&wx_co=1&tp=webp)



### 三维几何中曲线和曲面理论

从数据结构上来看，几何面的创建和处理是三维内核几何数据结构和操作最核心的部分，也是其它类型包括Sheet，实体等数据操作的基础。

以曲面为例，通常我们将曲面分为两种：解析曲面和样条曲面，又叫插值曲面，解析曲面有函数表达式f(x,y,z)，即给出任意坐标值，可以准确的计算出该坐标的数据，有点类似偏微分方程的解析解，解析曲面通常可以高阶连续，在研究特定图形时很有用。而插值曲面则是通过一系列离散的坐标点或者离散的曲线插值构成。

### 几何数据库

几何数据库是关于存储、查询和处理几何对象及其属性的数据库。主要用来表示和管理各种几何数据，并提供了方法来处理这些数据以支持空间分析、计算机辅助设计（CAD），地理信息系统（GIS）等应用。主要以下几个方面：

1.数据表示和存储：以数据结构的形式存储点、线、多边形等几何对象，以及如何表示它们的拓扑关系和属性信息。

2.空间索引和查询：对于大规模的几何数据集，高效地查询和检索是至关重要的。设计空间索引结构（例如R树、四叉树等）来加速空间查询，比如范围查询、最近邻查询等，以便快速地定位和检索需要的几何对象。

3.拓扑关系和空间分析：这个领域研究了几何对象之间的拓扑关系，比如相交、包含、连接等，以及如何进行空间分析，例如几何缓冲区分析、空间连接和交叉分析等，为GIS等应用提供支持。

4.几何数据的一致性和完整性：几何数据库理论还关注几何数据的一致性和完整性，确保存储的几何对象满足一定的规范和约束条件，以防止数据不一致或错误。

5.提供历史树记录比如撤消重做，方便上层功能调用



### 参数特征建模技术

1. 特征化建模。将设计目标分解为特征元素，如孔，槽，阵列等,每种特征都表现一种设计意图。用户通过添加和编辑特征来构建设计模型，无需处理底层几何实体。
2. 特征参数化。特征具有参数化定义，如圆孔特征包括中心坐标，直径等参数。用户通过修改，参数值来调整特征,系统自动更新几何模型。
3. 特征关联。不同特征间可以建立几何约束关联关系,如平行，同心，对称等。当用户调整一个特征时，所有关联特征会自动更新，保持几何关联关系的满足。

### 约束求解器

三维几何约束求解器是一类专门用于求解三维场景中对象之间几何约束关系的算法。它可以确定满足一组指定约束条件的三维场景对象的位置、方向等参数。

三维场景中的对象通常通过变换关系确定其位置和方向，如平移，旋转，缩放等。对象之间通过各种几何约束相互关联，例如点到点距离约束，点到面距离约束，方向约束等。

一个典型的约束求解过程包括建模，求解和更新三个阶段。首先根据场景中对象的几何特性建立约束方程组模型。然后使用迭代算法求解方程组，最后更新场景中对象的状态。

Geometric Constrained Solver(GCS)

二维GCS，又叫草图几何约束求解器，简称草图约束，它描述的是在二维平面设计时所用的几何约束功能。

二维里常见的三种约束类型：

尺寸约束：点点距离，点线距离，线线夹角，圆弧长度，圆和圆弧半径

结构约束：线水平或垂直，两线平行，线和圆相切

业务约束：用户自定义参数变量之间约束。

几何约束解算器是一种软件组件，用于求解尺寸和约束以指定和保留 2D 或 3D 设计中的几何特征位置。在计算机辅助设计 (CAD) 中，几何约束求解器可在基于历史记录的参数化建模和变分直接建模中实现快速设计改进。

用户通过输入几何约束来描述物体之间的关系，如长度，角度，相对位置，对称性等。这些约束条件可以是固定的值，也可以是范围或比例关系。求解器根据输入的约束条件，尝试找到满足这些条件的物体形状或位置。尝试调整设计的各个参数，直到找到满足所有约束条件的最优解。



### 拾取和捕捉

捕捉和拾取是在行业软件中最常用的交互方式，其中拾取就是在视图中选择对象，而捕捉是为了方便的拾取，创建和编辑对象。

视图中一般以几何数据和网格数据为主。关于捕捉和拾取的开发，涉及到软件技术选型，几何内核，渲染引擎，性能提升，约束求解等诸多内容，是前处理软件中研发的难点



### 几何对象属性计算

几何对象属性计算是计算各种几何形状（如点、线、面、体等）的特征，性质或参数，包括但不限于长度，面积，体积，曲率，法向量，几何中心，边界框，表面积，惯性等。

属性计算在计算机图形学，CAD，CAM，前处理软件，工程建模等领域有着广泛的应用。它有助于理解几何形状的特性，优化设计和渲染过程，或者用于物理仿真，碰撞检测和视觉效果的实现。

几何对象属性计算是工业软件中的一个基本内容，在CAD等软件中一般在几何内核中实现。



### CUDA技术

Compute Unified Device Architecture

是由NVIDIA公司推出的并行计算平台和编程模型，旨在利用GPU(图形处理器)进行通用目的的并行计算，加速科学计算，深度学习，图形处理和其他计算密集型任务。

### 布尔运算

> 布尔运算是软件底层开发可以一直研究的内容

布尔运算简单理解就是两个物体之间的关系运算，常用的有

布尔并：两个物体合并为一个

布尔交：两个物体的公共部分

布尔减：一个物体减去另外一个物体

在此基础上衍生出各种操作，比如chop，slice，glue等，本质上都属于布尔运算，更一般化，布尔运算不仅存在于基于BRep结构的三维几何内核中，在CGS，基于样条曲面结构，网格中也应用广泛，是常用的数据运算。



### 网格数据结构

在三维几何中，常用的数据结构是边界表示法数据结构，这种表示方法用拓扑和几何建立了完整通用的三维数据表达。

与之对应的网格数据则简单很多，仿真中使用点和单元连接关系则可以表达。但在网格生成和优化中需要用到更为复杂的数据结构。比如需要查询某个点和哪些边，哪些面，哪些单元相接触。网格加密中，找出一个单元一定范围内的单元，网格排序重编号等等。仅仅有点和单元数据是不够的，需要更多数据来表达，比如类似半边结构的拓扑，建立网格数据库等等。

另外网格数据普遍较多，不仅从功能上，还要从性能上考虑。

